<!doctype html>
<html lang="en" data-theme="dark">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>HubbTIME · HubbFISCAL</title>
  <meta name="description" content="Town of Hubbardston — Non-Union Biweekly Timesheet (HubbTIME)" />
  <link rel="icon" href="assets/favicon.svg" />
  <link rel="stylesheet" href="css/main.css" />
</head>
<body>
  <a class="skip-link sr-only" href="#main">Skip to content</a>

  <header class="site-header">
    <div class="brand">
      <div class="seal" aria-hidden="true">H</div>
      <div class="brand-text">
        <h1 class="site-title">HubbFISCAL</h1>
        <p class="tagline">Town of Hubbardston · Budget & Financial Management Hub</p>
      </div>
    </div>
    <nav class="main-nav" aria-label="Primary" aria-expanded="false">
      <button class="nav-toggle" aria-expanded="false" aria-controls="navList">Menu</button>
      <ul id="navList">
        <li><a href="index.html">Home</a></li>
        <li><a href="fy27/index.html">FY27 Budget</a></li>
        <li><a href="reports/index.html">Reports</a></li>
        <li><a href="benchmarks/index.html">Benchmarks</a></li>
        <li><a href="capital/index.html">Capital</a></li>
        <li><a href="grants/index.html">Grants</a></li>
        <li><a href="checkbook/index.html">Checkbook</a></li>
        <li><a href="meetings/index.html">Meetings</a></li>
        <li><a href="participate/index.html">Participate</a></li>
        <li><a href="Hubbtime.html" class="active">HubbTIME</a></li>
      </ul>
    </nav>
    <div style="margin-left: auto;">
      <button id="themeToggle" class="btn ghost" aria-pressed="false">Light</button>
    </div>
  </header>

  <main id="main" class="container">
    <div id="hubbtimeContainer">
      <header class="page-header">
        <h1>Town of Hubbardston — Enhanced Biweekly Timesheet</h1>
        <p>Smart timesheet system with automated calculations and municipal GL integration</p>
      </header>

      <form id="timesheetForm">
        <div id="systemMsg" class="alert info" role="status" aria-live="polite" style="display:none;"></div>

        <!-- Employee Information Section -->
        <section class="card">
          <div class="card-header">
            <h2 class="card-title">Employee Information</h2>
          </div>
          
          <div class="form-group">
            <label class="label" for="employeeSearch">Employee (search by name)</label>
            <div style="display:flex; gap:var(--space-sm); align-items:center;">
              <input 
                id="employeeSearch" 
                list="employeeList" 
                placeholder="Start typing a name..." 
                autocomplete="off" 
                class="input"
              >
              <button type="button" class="btn secondary" id="clearEmployeeBtn">Clear</button>
            </div>
            <datalist id="employeeList"></datalist>
            <input type="hidden" id="employeeIndex" value="">
          </div>

          <div class="employee-info" id="employeeDetails" style="display:none;">
            <div class="totals-grid">
              <div class="total-item">
                <div class="total-label">Department</div>
                <div class="total-value" id="department">—</div>
              </div>
              <div class="total-item">
                <div class="total-label">Pay Type</div>
                <div class="total-value" id="payType">—</div>
              </div>
              <div class="total-item">
                <div class="total-label">Rate / Salary</div>
                <div class="total-value" id="rate">—</div>
              </div>
            </div>
          </div>
        </section>

        <!-- Pay Period Selection -->
        <section class="card">
          <div class="card-header">
            <h2 class="card-title">Pay Period</h2>
          </div>
          
          <div class="form-group">
            <label class="label" for="warrant">Select Pay Period</label>
            <select id="warrant" class="input">
              <option value="">Select Pay Period...</option>
            </select>
          </div>
        </section>

        <!-- Time Entries Section -->
        <section class="card">
          <div class="card-header">
            <h2 class="card-title">Time Entries</h2>
          </div>

          <div class="quick-actions">
            <button type="button" class="btn primary" id="addRowBtn">Add Row</button>
            <button type="button" class="btn secondary" id="townHallBtn">Town Hall Hours</button>
            <button type="button" class="btn secondary" id="splitShiftBtn">Split Shift</button>
            <button type="button" class="btn secondary" id="overtimeBtn">Overtime Day</button>
            <button type="button" class="btn secondary" id="sickBtn">Sick Day</button>
            <button type="button" class="btn secondary" id="personalBtn">Personal Day</button>
            <button type="button" class="btn secondary" id="vacationBtn">Vacation Day</button>
            <button type="button" class="btn secondary" id="holidayBtn">Holiday</button>
            <button type="button" class="btn danger" id="clearAllBtn">Clear All</button>
          </div>

          <div class="table-container">
            <div class="tableWrap">
              <table>
                <thead>
                  <tr>
                    <th>Date</th>
                    <th>Start Time</th>
                    <th>End Time</th>
                    <th>Hours</th>
                    <th>Type</th>
                    <th>GL Code</th>
                    <th>Description</th>
                    <th>Actions</th>
                  </tr>
                </thead>
                <tbody id="timeBody">
                  <!-- Dynamic rows will be inserted here -->
                </tbody>
              </table>
            </div>
          </div>
        </section>

        <!-- Summary Section -->
        <section class="card">
          <div class="card-header">
            <h2 class="card-title">Summary</h2>
          </div>

          <div class="totals-panel">
            <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:var(--space-md);">
              <div>
                <div class="total-label">Total Hours This Period</div>
                <div id="totalHours" class="total-value">0.00</div>
              </div>
              <div style="text-align:right;">
                <div class="total-label">Estimated Gross Pay</div>
                <div id="grossPay" class="total-value">$0.00</div>
              </div>
            </div>
          </div>

          <div class="totals-grid">
            <div class="total-item">
              <div class="total-label">Regular</div>
              <div class="total-value" id="sumRegular">0.00</div>
            </div>
            <div class="total-item">
              <div class="total-label">Sick</div>
              <div class="total-value" id="sumSick">0.00</div>
            </div>
            <div class="total-item">
              <div class="total-label">Personal</div>
              <div class="total-value" id="sumPersonal">0.00</div>
            </div>
            <div class="total-item">
              <div class="total-label">Vacation</div>
              <div class="total-value" id="sumVacation">0.00</div>
            </div>
            <div class="total-item">
              <div class="total-label">Holiday</div>
              <div class="total-value" id="sumHoliday">0.00</div>
            </div>
          </div>
        </section>

        <!-- GL Review Section -->
        <section class="card">
          <div class="card-header">
            <h2 class="card-title">GL Review — Hours & Cost Allocation</h2>
          </div>
          
          <div id="glReviewWrap" class="table-container">
            <p class="text-center text-muted" style="padding:var(--space-xl);">
              Enter time entries above to see GL code breakdown and cost allocation
            </p>
          </div>
          
          <div class="alert info">
            <strong>Smart Allocation:</strong> 
            Hourly employees: Regular hours automatically convert to overtime (1.5x rate) when weekly total exceeds 40 hours. 
            Salary employees: Biweekly salary split proportionally across GL codes based on time allocation.
          </div>
        </section>

        <!-- Submit Section (with compliance + signature notice) -->
        <section class="card text-center">
          <div class="alert info" role="note" aria-label="Compliance Notice" style="margin-bottom:var(--space-md); text-align:left;">
            <p><strong>Compliance Notice:</strong></p>
            <p>
              By selecting “Submit Timesheet,” you attest that the information provided is accurate and complete to the best of your knowledge. 
              Your submission constitutes your electronic signature and certification in accordance with Massachusetts General Laws, including 
              public records requirements (MGL c. 66) and attestations made under penalty of perjury (MGL c. 268 §6A).
            </p>
          </div>

          <button type="submit" class="btn primary" id="submitBtn" style="padding:var(--space-md) var(--space-xl); font-size:1.1rem;">
            Submit Timesheet
          </button>
          <div id="submitStatus" class="mt-md"></div>
        </section>
      </form>
    </div>
  </main>

  <footer class="site-footer text-center" style="margin-top:var(--space-3xl); padding:var(--space-lg); color:var(--muted);">
    <p>&copy; 2025 Town of Hubbardston, MA · <a href="mailto:admin@hubbardstonma.gov">admin@hubbardstonma.gov</a></p>
  </footer>

  <!-- Status Indicators -->
  <div class="status-indicator saving" id="autoSaveIndicator" style="position:fixed; top:var(--space-md); right:var(--space-md); opacity:0; transition:opacity 0.3s ease; z-index:1000;" aria-live="polite">
    <div class="loading-spinner"></div>
    Auto-saved
  </div>

  <script>
    // Use the complete JavaScript from the "HubbTIME Complete Final Version" artifact
    // Place the entire JavaScript code here between these script tags
  </script>
</body>
</html>
